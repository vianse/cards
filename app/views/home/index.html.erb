<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>vi-cards</title>
</head>
<style>
   .visible {
    display: none;
  }
  .imagen {
    object-fit: cover !important;
    border-radius: 50% !important;
    width: 150px;
    height: 150px;
  }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<body style="display: block;">

    <!-- NAVIGATION
    ================================================== -->

   <%= render 'navegacion/menu' %>

    <!-- MAIN CONTENT
    ================================================== -->
    <div class="main-content">

        <div class="header">

            <!-- Image -->
            <div class="card-img-top">
                <img id="cover" src="" class="header-img-top transform scale-95"
                alt="...">
            </div>
            <div class="container-fluid">

                <!-- Body -->
                <div class="header-body mt-n5 mt-md-n6">
                    <div class="row align-items-end">
                        <div class="col-auto">

                            <!-- Avatar -->
                            <div class="flex w-48 justify-center">
                                <img src=""
                                    alt="..." class="imagen" id="avatar">
                            </div>

                        </div>
                        <div class="col mb-3 ml-n3 ml-md-n2">

                            <!-- Pretitle -->
                            <h6 class="text-xl text-gray-500 mt-3" id="depto">
                                PUESTO
                            </h6>

                            <!-- Title -->
                            <h1 class="text-2xl mt-2"  id="name">
                                NOMBRE COMPLETO
                            </h1>

                        </div>
                        <div class="col-12 col-md-auto mt-2 mt-md-0 mb-md-3">

                            <!-- Button 
                            <a href="#!" class="btn btn-primary d-block d-md-inline-block lift">
                                Subscribe
                            </a>-->

                        </div>
                    </div> <!-- / .row -->
                    <div class="row align-items-center">
                        <div class="col">
                          <ul class="flex flex-row flex-wrap lg:flex-nowrap justify-start ">
                            <li class="flex flex-col pt-5 pb-5 pl-2 pr-2">
                              <div class=" self-center w-8">
                                <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                  <title>WhatsApp</title>
                                  <path style="fill:#25D366;"
                                    d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z" />
                                </svg>
                              </div>
                              <div id="whats" class="mt-2"></div>
                            </li>
                            <li class="flex flex-col pt-5 pb-5 pl-3 pr-2">
                              <div class=" self-center w-8">
                                <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                  <title>Teléfono</title>
                                  <path style="fill:#1b1b1b;"
                                    d="M2.49 5.114l8.3-4.79a2.421 2.421 0 012.39-.017l.03.017 8.299 4.79c.74.427 1.2 1.212 1.211 2.065V16.79c0 .854-.451 1.645-1.184 2.08l-.027.016-8.299 4.79a2.42 2.42 0 01-2.39.017l-.03-.017-8.3-4.79a2.421 2.421 0 01-1.21-2.065V7.21c0-.855.45-1.645 1.184-2.08l.026-.016 8.3-4.79zM12 4.026L5.092 8.013v7.974L12 19.974V12l6.908-3.987z" />
                                </svg>
                              </div>
                              <div id="movil" class="mt-2"></div>
                            </li>
                            <li class="flex flex-col pt-5 pb-5 pl-4 pr-4">
                              <div>
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"
                                  id="Capa_1" x="0px" y="0px" viewBox="0 0 512.001 512.001"
                                  style="enable-background:new 0 0 512.001 512.001;" xml:space="preserve">
                                  <path style="fill:#1E88E5;"
                                    d="M499.628,407.468c-10.128,12.16-25.134,19.194-40.96,19.2H53.334  c-15.826-0.006-30.832-7.04-40.96-19.2l195.627-162.987l20.267,13.867c16.695,11.52,38.772,11.52,55.467,0l20.267-13.867  L499.628,407.468z" />
                                  <path style="fill:#64B5F6;"
                                    d="M502.614,108.588L304.001,244.481l-20.267,13.867c-16.695,11.52-38.772,11.52-55.467,0  l-20.267-13.867L9.388,108.374c9.994-14.411,26.409-23.017,43.947-23.04h405.333C476.285,85.241,492.781,93.969,502.614,108.588z" />
                                  <g>
                                    <path style="fill:#2196F3;"
                                      d="M208.001,244.481L12.374,407.468c-8.007-9.57-12.388-21.655-12.373-34.133V138.668   c-0.065-10.823,3.214-21.403,9.387-30.293L208.001,244.481z" />
                                    <path style="fill:#2196F3;"
                                      d="M512.001,138.668v234.667c0.014,12.478-4.366,24.563-12.373,34.133L304.001,244.481l198.613-135.893   C508.756,117.414,512.033,127.915,512.001,138.668z" />
                                  </g>
                                </svg>
                                <div id="email"></div>
                              </div>
                            </li>
                            <li class="flex flex-col pt-5 pb-5 pl-4 pr-4">
                              <div class=" self-center w-8">
                                <a href="http://www.nissanecatepec.com.mx" target="_blank" class="">
                                  <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <title>Página Web</title>
                                    <path style="fill:#1E88E5;"
                                      d="M12 0C8.21 0 4.831 1.757 2.632 4.501l3.953 6.848A5.454 5.454 0 0 1 12 6.545h10.691A12 12 0 0 0 12 0zM1.931 5.47A11.943 11.943 0 0 0 0 12c0 6.012 4.42 10.991 10.189 11.864l3.953-6.847a5.45 5.45 0 0 1-6.865-2.29zm13.342 2.166a5.446 5.446 0 0 1 1.45 7.09l.002.001h-.002l-5.344 9.257c.206.01.413.016.621.016 6.627 0 12-5.373 12-12 0-1.54-.29-3.011-.818-4.364zM12 16.364a4.364 4.364 0 1 1 0-8.728 4.364 4.364 0 0 1 0 8.728Z" />
                                  </svg>
                                  <div class="mt-2">Web</div>
                                </a>
                              </div>
                            </li>
                            <li class="flex flex-col pt-5 pb-5 pl-3 pr-2">
                              <div class="self-center w-8">
                                <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                  <title>Facebook</title>
                                  <path style="fill:#1877F2;"
                                    d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
                                </svg>
                              </div>
                              <a href="https://facebook.com/pages/category/Car-Dealership/nissaneca3030/posts/?locale2=es_LA" target="_blank"
                                class="">
                                <div class="mt-2">Facebook</div>
                              </a>
                            </li>
                            <li class="flex flex-col pt-5 pb-5 pl-3 pr-2">
                              <div class="self-center w-8">
                              <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Compartir</title>
                                <path style="fill:#fc6565;" d="M9.71 2.136a1.43 1.43 0 0 0-2.047 0h-.007a1.48 1.48 0 0 0-.421 1.042c0 .41.161.777.422 1.039l.007.007c.257.264.616.426 1.019.426.404 0 .766-.162 1.027-.426l.003-.007c.261-.262.421-.629.421-1.039 0-.408-.159-.777-.421-1.042H9.71zM8.683 22.295c.404 0 .766-.167 1.027-.429l.003-.008c.261-.261.421-.631.421-1.036 0-.41-.159-.778-.421-1.044H9.71a1.42 1.42 0 0 0-1.027-.432 1.4 1.4 0 0 0-1.02.432h-.007c-.26.266-.422.634-.422 1.044 0 .406.161.775.422 1.036l.007.008c.258.262.617.429 1.02.429zm7.89-4.462c.359-.096.683-.33.882-.684l.027-.052a1.47 1.47 0 0 0 .114-1.067 1.454 1.454 0 0 0-.675-.896l-.021-.014a1.425 1.425 0 0 0-1.078-.132c-.36.091-.684.335-.881.686-.2.349-.241.75-.146 1.119.099.363.33.691.675.896h.002c.346.203.737.239 1.101.144zm-6.405-7.342a2.083 2.083 0 0 0-1.485-.627c-.58 0-1.103.242-1.482.627-.378.385-.612.916-.612 1.507s.233 1.124.612 1.514a2.08 2.08 0 0 0 2.967 0c.379-.39.612-.923.612-1.514s-.233-1.122-.612-1.507zm-.835-2.51c.843.141 1.6.552 2.178 1.144h.004c.092.093.182.196.265.299l1.446-.851a3.176 3.176 0 0 1-.047-1.808 3.149 3.149 0 0 1 1.456-1.926l.025-.016a3.062 3.062 0 0 1 2.345-.306c.77.21 1.465.721 1.898 1.482v.002c.431.757.518 1.626.313 2.408a3.145 3.145 0 0 1-1.456 1.928l-.198.118h-.02a3.095 3.095 0 0 1-2.154.201 3.127 3.127 0 0 1-1.514-.944l-1.444.848a4.162 4.162 0 0 1 0 2.879l1.444.846c.413-.47.939-.789 1.514-.944a3.041 3.041 0 0 1 2.371.319l.048.023v.002a3.17 3.17 0 0 1 1.408 1.906 3.215 3.215 0 0 1-.313 2.405l-.026.053-.003-.005a3.147 3.147 0 0 1-1.867 1.436 3.096 3.096 0 0 1-2.371-.318v-.006a3.156 3.156 0 0 1-1.456-1.927 3.175 3.175 0 0 1 .047-1.805l-1.446-.848a3.905 3.905 0 0 1-.265.294l-.004.005a3.938 3.938 0 0 1-2.178 1.138v1.699a3.09 3.09 0 0 1 1.56.862l.002.004c.565.572.914 1.368.914 2.243 0 .873-.35 1.664-.914 2.239l-.002.009a3.1 3.1 0 0 1-2.21.931 3.1 3.1 0 0 1-2.206-.93h-.002v-.009a3.186 3.186 0 0 1-.916-2.239c0-.875.35-1.672.916-2.243v-.004h.002a3.1 3.1 0 0 1 1.558-.862v-1.699a3.926 3.926 0 0 1-2.176-1.138l-.006-.005a4.098 4.098 0 0 1-1.173-2.874c0-1.122.452-2.136 1.173-2.872h.006a3.947 3.947 0 0 1 2.176-1.144V6.289a3.137 3.137 0 0 1-1.558-.864h-.002v-.004a3.192 3.192 0 0 1-.916-2.243c0-.871.35-1.669.916-2.243l.002-.002A3.084 3.084 0 0 1 8.683 0c.861 0 1.641.355 2.21.932v.002h.002c.565.574.914 1.372.914 2.243 0 .876-.35 1.667-.914 2.243l-.002.005a3.142 3.142 0 0 1-1.56.864v1.692zm8.121-1.129l-.012-.019a1.452 1.452 0 0 0-.87-.668 1.43 1.43 0 0 0-1.103.146h.002c-.347.2-.58.529-.677.896-.095.365-.054.768.146 1.119l.007.009c.2.347.519.579.874.673.357.103.755.059 1.098-.144l.019-.009a1.47 1.47 0 0 0 .657-.885 1.493 1.493 0 0 0-.141-1.118"/></svg>
                            </div>
                              <div id="link" class="mt-2"></div>
                              <div id="image"></div>
                          </li>
                          <li class="flex flex-col pt-5 pb-5 pl-3 pr-2">
                            <div class="self-center w-8">
                              <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Precios</title>
                                <path style="fill:#00C244;" d="M23.59 3.475a5.1 5.1 0 00-3.05-3.05c-1.31-.42-2.5-.42-4.92-.42H8.36c-2.4 0-3.61 0-4.9.4a5.1 5.1 0 00-3.05 3.06C0 4.765 0 5.965 0 8.365v7.27c0 2.41 0 3.6.4 4.9a5.1 5.1 0 003.05 3.05c1.3.41 2.5.41 4.9.41h7.28c2.41 0 3.61 0 4.9-.4a5.1 5.1 0 003.06-3.06c.41-1.3.41-2.5.41-4.9v-7.25c0-2.41 0-3.61-.41-4.91zm-6.17 4.63l-.93.93a.5.5 0 01-.67.01 5 5 0 00-3.22-1.18c-.97 0-1.94.32-1.94 1.21 0 .9 1.04 1.2 2.24 1.65 2.1.7 3.84 1.58 3.84 3.64 0 2.24-1.74 3.78-4.58 3.95l-.26 1.2a.49.49 0 01-.48.39H9.63l-.09-.01a.5.5 0 01-.38-.59l.28-1.27a6.54 6.54 0 01-2.88-1.57v-.01a.48.48 0 010-.68l1-.97a.49.49 0 01.67 0c.91.86 2.13 1.34 3.39 1.32 1.3 0 2.17-.55 2.17-1.42 0-.87-.88-1.1-2.54-1.72-1.76-.63-3.43-1.52-3.43-3.6 0-2.42 2.01-3.6 4.39-3.71l.25-1.23a.48.48 0 01.48-.38h1.78l.1.01c.26.06.43.31.37.57l-.27 1.37c.9.3 1.75.77 2.48 1.39l.02.02c.19.2.19.5 0 .68z"/></svg>
                            </div>
                            <a href="#" id="price" target="_blank"
                              class="">
                              <div class="mt-2">Listada de Precios</div>
                            </a>
                          </li>
                        </div>
                    </div>
                </div> <!-- / .header-body -->

            </div>
        </div>
        <!-- / body -->
        <div class="container-fluid">
          <div class="text-3xl font-semibold pt-3 pb-2">
            Nuestras Promociones
          </div>
              <div id="promos"></div>
          </div>

    </div>

    </div><!-- / .main-content -->
   
    <div id="profile" class="visible"></div>
    <div id="uw" class="visible"></div>
    <div id="um" class="visible"></div>
    <div id="ue" class="visible"></div>
    
</body>



<style>
   
    img#cover {
        height: 300px!important;
        object-fit: cover;

    }
    button.nav-link{
        background-color: transparent;
    }

</style>

<script type="text/jsx">
    class Profile extends React.Component{
          constructor(props) {
            super(props);
            this.state = {
              data: []
            }
            
        }
          componentDidMount() {

            firebase.auth().onAuthStateChanged(function(user) {
                if (user) {
                   
                    var database = firebase.database();
                    var ref = database.ref("profiles/" + user.uid);
                    ref.once('value', snap => {
                        const shop = {
                                id: snap.key,
                                data: snap.val(),
                          };
                          $("#name").text(shop.data.name);
                          $("#depto").text(shop.data.depto);
                });
                } else {
                  // No user is signed in.
                }
              });
        }
            render(){
              
                return(
                        <div>

                        </div>
                )
            }
      }
      ReactDOM.render(<Profile />,document.getElementById('profile'));

      class Whats extends React.Component{
        constructor(props) {
          super(props);
          this.state = {
            datos: []
          }
          
      }
        componentDidMount() {
            var self = this
          firebase.auth().onAuthStateChanged(function(user) {
              if (user) {
                  
                  var database = firebase.database();
                  var ref = database.ref("profiles/" + user.uid);
                  ref.once('value', snap => {
                      const shop = {
                              id: snap.key,
                              data: snap.val(),
                        };
                        $("#uw").text(shop.data.whats)
                        self.setState({
                            datos: $("#uw").html()
                        })   
                        
              });
              
              } else {
                // No user is signed in.
              }
            });
      }
          render(){
            
                var whats = this.state.datos
                var url = "https://api.whatsapp.com/send?phone=" + whats
              return(
                      <div>
                        <a href={url}  target="blank" className="">
                            WhatsApp
                        </a>
                      </div>
              )
          }
    }
    ReactDOM.render(<Whats />,document.getElementById('whats'));
    class Movil extends React.Component{
        constructor(props) {
          super(props);
          this.state = {
            datos: []
          }
          
      }
        componentDidMount() {
            var self = this
          firebase.auth().onAuthStateChanged(function(user) {
              if (user) {
                  
                  var database = firebase.database();
                  var ref = database.ref("profiles/" + user.uid);
                  ref.once('value', snap => {
                      const shop = {
                              id: snap.key,
                              data: snap.val(),
                        };
                        $("#um").text(shop.data.movil)
                        self.setState({
                            datos: $("#um").html()
                        })   
              });
              
              } else {
                // No user is signed in.
              }
            });
      }
          render(){
            
                var movil = this.state.datos
                var url = movil
              return(
                      <div>
                        <a href="#" target="blank" className="">
                            {url}
                        </a>
                      </div>
              )
          }
    }
    ReactDOM.render(<Movil />,document.getElementById('movil'));
    class Email extends React.Component{
        constructor(props) {
          super(props);
          this.state = {
            datos: []
          }
      }
        componentDidMount() {
            var self = this
          firebase.auth().onAuthStateChanged(function(user) {
              if (user) {
                  
                  var database = firebase.database();
                  var ref = database.ref("profiles/" + user.uid);
                  ref.once('value', snap => {
                      const shop = {
                              id: snap.key,
                              data: snap.val(),
                        };
                        $("#ue").text(shop.data.email)
                        self.setState({
                            datos: $("#ue").html()
                        })   
              });
              
              } else {
                // No user is signed in.
              }
            });
      }
          render(){
            
                var email = this.state.datos
                var url = "mailto:" + email
              return(
                      <div>
                        <a href={url} target="blank" className="">
                            Email
                        </a>
                      </div>
              )
          }
    }
    ReactDOM.render(<Email />,document.getElementById('email'));
    class Link extends React.Component{
        constructor(props) {
          super(props);
          this.state = {
            datos: []
          }
          
      }
        componentDidMount() {
          $('[data-toggle="popover"]').popover()
            var self = this
          firebase.auth().onAuthStateChanged(function(user) {
              if (user) {
                        self.setState({
                            token: user.uid
                        })   
              } else {
                // No user is signed in.
              }
            });
      }
          render(){
            
                var token = this.state.token
                var url = "https://" + window.location.host + "/public?token=" + "'" + token
              return(
                      <div>
                        
                        <button type="button" className="" data-container="body" data-toggle="popover" data-placement="right" data-content={url} data-original-title="" title="" aria-describedby="popover310984">
                            Compartir
                          </button>
                      </div>
              )
          }
    }
    ReactDOM.render(<Link />,document.getElementById('link'));

    class Imagen extends React.Component{
        constructor(props) {
          super(props);
          this.state = {
            datos: []
          }
          
      }
        componentDidMount() {
            var self = this
          firebase.auth().onAuthStateChanged(function(user) {
              if (user) {
                  
                var storage = firebase.storage();
                var storageRef = storage.ref()
                var storageRef_cover = storage.ref()
                var storageRef_price = storage.ref()
                var starsRef = storageRef.child('profile').child(user.uid).child(user.uid);
                var starsRef_cover = storageRef_cover.child('cover').child(user.uid).child(user.uid);
                var starsRef_price = storageRef_price.child('price').child("lista").child("actual");
                starsRef.getDownloadURL().then(function(url) {
                $("#avatar").attr('src', url)
                }).catch(function(error) {
                  switch (error.code) {
                    case 'storage/object-not-found':
                    break;
                    case 'storage/unauthorized':
                    break;
                    case 'storage/canceled':
                    break;
                    case 'storage/unknown':
                    break;
                  }
                });
                starsRef_cover.getDownloadURL().then(function(url) {
                    $("#cover").attr('src', url)
                  }).catch(function(error) {
                    switch (error.code) {
                      case 'storage/object-not-found':
                      break
                      case 'storage/unauthorized':
                      break;
                      case 'storage/canceled':
                      break;
                      case 'storage/unknown':
                      break;
                    }
                  });
                  
                  starsRef_price.getDownloadURL().then(function(url) {
                    $("#price").attr('href', url)
                  }).catch(function(error) {
                    switch (error.code) {
                        case 'storage/object-not-found':
                        break;
                        case 'storage/unauthorized':
                        break;
                        case 'storage/canceled':
                        break;
                        case 'storage/unknown':
                        break;
                    }
                  });
              } else {
                // No user is signed in.
              }
            });
      }
          render(){
                var token = this.state.token
                var url = window.location.host + "/me?token=" + token 
              return(
                      <div>
                      </div>
              )
          }
    }
    ReactDOM.render(<Imagen />,document.getElementById('image'));

    class Promociones extends React.Component{
        constructor(props) {
          super(props);
          this.state = {
            dato: []
          }
      }
        componentDidMount() {
            var self = this
        firebase.auth().onAuthStateChanged(function(user) {
          if (user) {
            var database = firebase.database();
        
            var ref = database.ref("business")//.child(user.uid)
            ref.orderByChild("estatusId").equalTo(2).on('child_added', snap => { 
            
            const shop = {
              id: snap.key,
              data: snap.val(),
            };
              var newArr = self.state.dato
              newArr.push(shop);
                self.setState({
                    dato: self.state.dato, arr:newArr
                });
            });
          } else {
            // No user is signed in.
          }
        });
      }
      render(){
                var token = this.state.token
                var url = window.location.host + "/me?token=" + token 
                var lista = this.state.dato
                var list = lista.map(function(o,i){
                    var file = o.data.file
                    if(o.data.tipo == "video"){
                        var imagenVideo = <video  controls>
                            <source src={file} type="video/mp4" />
                          </video>
                    }
                    else{
                        var imagenVideo = <img src={file} alt="..." className="avatar-img rounded transform scale-95 " />
                    }
                    return(
                        <div className="col-12 col-lg-3">
                            <div className="card" >
                              <a href="#">
                                {imagenVideo}
                              </a>
                                <div className="card-body">
                                  <div className="row align-items-center mb-4">
                                  <div className="col font-sans">
                                    {o.data.nombre}
                                  </div>
                                </div> 
                              </div> 
                            </div>
                        </div>
                    )
                })
              return(
                <div className="row">{list} </div>
              )
      }
    }
    ReactDOM.render(<Promociones />,document.getElementById('promos'));
      </script>
    